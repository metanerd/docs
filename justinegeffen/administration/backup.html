


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Backup and Disaster Recovery &mdash; Mattermost 5.31 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme.css" type="text/css" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Bleve Search (Experimental)" href="../deployment/bleve.html" />
    <link rel="prev" title="Client-side Data Storage FAQ" href="../deployment/client-side-data.html" />
	<!-- Google Tag Manager -->
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-K874RWM');</script>
	<!-- End Google Tag Manager -->


  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Mattermost
          

          
          </a>

          
            
            
              <div class="version">
                5.31
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/cloud-admin-guide.html">Cloud Administrator's Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../guides/administrator.html">Self-Managed Administrator's Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview/architecture.html">Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deployment/deployment.html">Deployment Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#installing-mattermost">Installing Mattermost</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../guides/administrator.html#deployment">Deployment</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../deployment/deployment.html">Deployment Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment/desktop-app-deployment.html">Desktop App Deployment Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mobile/mobile-appconfig.html">AppConfig for EMM Solutions with Mattermost Mobile Apps</a></li>
<li class="toctree-l3"><a class="reference internal" href="image-proxy.html">Image Proxy</a></li>
<li class="toctree-l3"><a class="reference internal" href="encryption.html">Encryption Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../deployment/client-side-data.html">Client-side Data Storage FAQ</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Backup and Disaster Recovery</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#backup">Backup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#disaster-recovery">Disaster Recovery</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../deployment/bleve.html">Bleve Search (Experimental)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#configure-mattermost">Configure Mattermost</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#incident-management">Incident Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#mobile-apps">Mobile Apps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#onboard-users">Onboard Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#administration">Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#upgrade-mattermost">Upgrade Mattermost</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#mattermost-integrations">Mattermost Integrations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#mattermost-compliance">Mattermost Compliance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#scaling-mattermost">Scaling Mattermost</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#community-managed-documentation">Community-Managed Documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../guides/user.html">User's Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/integration.html">Integration Guide</a></li>
<li class="toctree-l1"><a class="reference external" href="https://developers.mattermost.com/">Developer's Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Mattermost</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          


  


<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
    
      <li><a href="../guides/administrator.html">Self-Managed Administrator’s Guide</a> &raquo;</li>
    
    <li>Backup and Disaster Recovery</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/mattermost/docs/blob/master/source/administration/backup.rst" class="fa fa-github"> Edit</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="backup-and-disaster-recovery">
<h1>Backup and Disaster Recovery<a class="headerlink" href="#backup-and-disaster-recovery" title="Permalink to this headline">¶</a></h1>
<p>Options to protect your Mattermost server from different types of failures range from simple backup to sophisticated disaster recovery deployments and automation.</p>
<div class="section" id="backup">
<h2>Backup<a class="headerlink" href="#backup" title="Permalink to this headline">¶</a></h2>
<p>The state of your Mattermost server is contained in multiple data stores that need to be separately backed up and restored to fully recover your system from failure.</p>
<p>To back up your Mattermost server:</p>
<ol class="arabic">
<li><p class="first">Back up your Mattermost database using standard MySQL or PostgreSQL procedures depending on your database version.</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://dev.mysql.com/doc/refman/5.6/en/backup-types.html">MySQL backup documentation</a> is available online. Use the selector on the page to choose your MySQL version.</li>
<li><a class="reference external" href="https://www.postgresql.org/docs/9.5/static/backup-dump.html">PostgreSQL backup documentation</a> is available online. Use the navigation at the top of the page to select your PostgreSQL version.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Back up your server settings stored in <code class="docutils literal notranslate"><span class="pre">config/config.json</span></code>.</p>
<blockquote>
<div><ul class="simple">
<li>If you are using SAML configuration for Mattermost, your SAML certificate files will be saved in the <code class="docutils literal notranslate"><span class="pre">config</span></code> directory. Therefore, it is recommended to back up the entire directory.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Back up files stored by your users with one of the following options:</p>
<blockquote>
<div><ul class="simple">
<li>If you use local storage using the default <code class="docutils literal notranslate"><span class="pre">./data</span></code> directory back up this directory.</li>
<li>If you use local storage using a non-default directory specified in the <code class="docutils literal notranslate"><span class="pre">Directory</span></code> setting in <code class="docutils literal notranslate"><span class="pre">config.json</span></code>, back up files in that location.</li>
<li>If you store your files in S3, you can typically keep the files where they are located without backup.</li>
</ul>
</div></blockquote>
</li>
</ol>
<p>Please note that to make a ‘clean’ backup you need to stop Mattermost during the duration of the backup otherwise the database and files may become out of sync.</p>
<p>To restore a Mattermost instance from backup, restore your database, <code class="docutils literal notranslate"><span class="pre">config.json</span></code> file, and optionally locally stored user files into the locations from which they were backed up.</p>
</div>
<div class="section" id="disaster-recovery">
<h2>Disaster Recovery<a class="headerlink" href="#disaster-recovery" title="Permalink to this headline">¶</a></h2>
<p>An appropriate disaster recovery plan weighs the benefits of mitigating specific risks against the cost and complexity of setting up disaster recovery infrastructure and automation.</p>
<p>There are two common approaches:</p>
<div class="section" id="automated-backup">
<h3>Automated backup<a class="headerlink" href="#automated-backup" title="Permalink to this headline">¶</a></h3>
<p>Automating backups for a Mattermost server provides a copy of the server’s state at a particular point in time, which can be restored if a failure in the future leads to loss of data. Options include:</p>
<ul class="simple">
<li>Automation to periodically back up the Mattermost server, which may include all the components listed above or a subset depending on what you choose to protect.</li>
<li>Automation to restore a server from backup, or deploy a new server, to reduce recovery time.</li>
<li>Automation to verify a backup has been successfully produced to protect against backup automation failures.</li>
<li>Storing backups off-site, to protect against physical loss of onsite systems.</li>
</ul>
<p>Recovering from a failure using a backup is typically a manual process and will incur downtime. The alternative is to automate recovery using a high availability deployment.</p>
</div>
<div class="section" id="high-availability-deployment">
<h3>High Availability deployment<a class="headerlink" href="#high-availability-deployment" title="Permalink to this headline">¶</a></h3>
<p>Deploying Mattermost in <a class="reference external" href="https://docs.mattermost.com/deployment/cluster.html">High Availability mode</a> allows for fast, automated recovery from component failure, such as a specific server running out of disk space or having a hardware issue, by running on redundant servers. Options include:</p>
<ul class="simple">
<li>Deploying redundant Mattermost servers, to protect against failures in the Mattermost server.</li>
<li>Deploying redundant databases, to protect against failures in the database.</li>
<li>Deploying redundant web proxies, to protect against failures in the web proxies.</li>
<li>Deploying redundant infrastructure in a separate physical data center, to protect against failures in the primary data center.</li>
</ul>
<p>A properly deployed High Availability deployment automatically switches over to a redundant system should a single server fail. High Availability does not protect against failures such as data corruption, since errors would propagate to redundant systems.</p>
<p>A “complete” disaster recovery solution would protect against both real-time hardware failures using High Availability, data corruption failures using automation, and failures of the primary data center by offering both offsite backup and offsite redundant infrastructure. Because the complexity of a full disaster recovery solution is high, it is common for customers to consider trade-offs in cost and complexity relative to the anticipated risks and target recovery times.</p>
</div>
<div class="section" id="failover-from-single-sign-in-outage">
<h3>Failover from single sign-in outage<a class="headerlink" href="#failover-from-single-sign-in-outage" title="Permalink to this headline">¶</a></h3>
<p>When using single sign-on with Mattermost Enterprise Edition an outage to your SSO provider can cause a partial outage on your Mattermost instance.</p>
<p><strong>What happens during an SSO outage?</strong></p>
<ul class="simple">
<li><strong>Most people can still log in.</strong> By default, when a user logs in to Mattermost they receive a session token lasting 30 days (the duration can be configured in the System Console). During an SSO outage, users with valid session tokens can continue to using Mattermost uninterrupted.</li>
<li><strong>Some people can’t log in.</strong> During an SSO outage, there are two situations under which a user cannot log in:<ul>
<li>Users whose session token expires during the outage</li>
<li>Users trying to log in to new devices</li>
</ul>
</li>
</ul>
<p>In each case, the user cannot reach the SSO provider, and cannot log in. In this case, there are several potential mitigations:</p>
</div>
<div class="section" id="configure-your-sso-provider-for-high-availability">
<h3>Configure your SSO provider for High Availability<a class="headerlink" href="#configure-your-sso-provider-for-high-availability" title="Permalink to this headline">¶</a></h3>
<p>If you’re using a self-hosted single sign-on provider, several options are available for <a class="reference external" href="https://docs.microsoft.com/en-us/microsoft-identity-manager/pam/high-availability-disaster-recovery-considerations-bastion-environment">High Availability configurations that protect your system from unplanned outages</a>.</p>
<p>For SaaS-based authentication providers, while you still have a dependency on service uptime, you can set up redundancy in source systems from which data is being pulled. For example, with the OneLogin SaaS-based authentication service, you can set up <a class="reference external" href="https://support.onelogin.com/hc/en-us/articles/204262680-High-Availability-for-LDAP">High Availability LDAP connectivity</a> to further reduce the chances of an outage.</p>
</div>
<div class="section" id="set-up-your-own-idp-to-provide-an-automated-or-manual-sso-failover-option">
<h3>Set up your own IDP to provide an automated or manual SSO failover option<a class="headerlink" href="#set-up-your-own-idp-to-provide-an-automated-or-manual-sso-failover-option" title="Permalink to this headline">¶</a></h3>
<p>Create a custom Identity Provider for SAML authentication that connects to both an active and a standby authentication option, that can be manually or automatically switched in case of an outage.</p>
<p>In this configuration, security should be carefully reviewed to prevent the standby SSO option from weakening your authentication protocols.</p>
</div>
<div class="section" id="set-up-a-manual-failover-plan-for-sso-outages">
<h3>Set up a manual failover plan for SSO outages<a class="headerlink" href="#set-up-a-manual-failover-plan-for-sso-outages" title="Permalink to this headline">¶</a></h3>
<p>When users are unable to reach your organization’s SSO provider during an outage, an error message directing them to contact your support link (defined in your System Console settings) is displayed.</p>
<p>Once IT is contacted about an SSO outage issue, they can temporarily change a user’s account from SSO to email-password using the System Console, and the end user can use password to claim the account, until the SSO outage is over and the account can be converted back to SSO.</p>
<p>If the administrator is unable to log into the System Console because of the SSO outage, they can switch their authentication method to email-password to gain access using the <a class="reference external" href="https://docs.mattermost.com/administration/command-line-tools.html">command line tool</a>.</p>
<p>When the outage is over, it’s critical to switch everyone back to SSO from email-password to maintain consistency and security.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../deployment/bleve.html" class="btn btn-neutral float-right" title="Bleve Search (Experimental)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../deployment/client-side-data.html" class="btn btn-neutral" title="Client-side Data Storage FAQ" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2020 Mattermost

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
 




<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-cog">&nbsp;&nbsp;Options</span>&nbsp;
        <span class="fa fa-angle-up"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Contribute</dt>
            <dd>
                <a href="https://github.com/mattermost/docs/issues">Report a Problem</a>
            </dd>
            
            <dd>
                <a href="https://github.com/mattermost/docs/blob/master/source/administration/backup.rst"> Edit on GitHub</a>
            </dd>
            
        </dl>
    </div>
</div>


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../_static/myscript.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
	<header>
	<div class="header__container">
		<div class="search__icon">
			<i class="fa fa-search"></i>
		</div>
		<a href="https://docs.mattermost.com/" class="header__logo">
			<img width="176" src="https://about.mattermost.com/wp-content/uploads/2017/08/Mattermost-Logo-Blue.svg">
		</a>
		<div class="links__icon">
			<i class="fa fa-bars"></i>
		</div>
		<ul class="header__links">
			<li><a href="https://developers.mattermost.com/">Developers</a></li>
			<li><a href="https://mattermost.com/features/">Product</a></li>
			<li><a href="https://mattermost.com/pricing/">Pricing</a></li>
			<li><a href="https://mattermost.com/blog/">Blog</a></li>
			<li><a href="https://mattermost.com/download/">Download</a></li>
			<li><a href="https://mattermost.com/trial/">Trial</a></li>
		</ul>
		<div class="header__searchbar">
			<form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
                <input type="text" name="q" placeholder="Search by keyword" autofocus />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
		</div>
	</div>
</header>
	<script type="text/javascript">
		/* Temporary fix for the search capability. Fix has been committed to the theme's master;
		   however, waiting a new release to the theme.  This fix should remain in place until that
		   time.  sphinx_rtd_theme is current v0.1.10a0. Commit for the fix in the
		   theme can be found at: https://github.com/snide/sphinx_rtd_theme/commit/a5e0e304
		 */
        if(DOCUMENTATION_OPTIONS) {
			DOCUMENTATION_OPTIONS.SOURCELINK_SUFFIX = '.txt'
        }
    </script>


</body>
</html>