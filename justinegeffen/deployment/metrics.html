


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Performance Monitoring (E20) &mdash; Mattermost 5.31 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme.css" type="text/css" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Mattermost Performance Alerting Guide" href="../administration/performance-alerting-guide.html" />
    <link rel="prev" title="Elasticsearch (E20)" href="elasticsearch.html" />
	<!-- Google Tag Manager -->
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-K874RWM');</script>
	<!-- End Google Tag Manager -->


  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Mattermost
          

          
          </a>

          
            
            
              <div class="version">
                5.31
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/cloud-admin-guide.html">Cloud Administrator's Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../guides/administrator.html">Self-Managed Administrator's Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview/architecture.html">Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="deployment.html">Deployment Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#installing-mattermost">Installing Mattermost</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#deployment">Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#configure-mattermost">Configure Mattermost</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#incident-collaboration">Incident Collaboration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#mobile-apps">Mobile Apps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#onboard-users">Onboard Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#administration">Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#upgrade-mattermost">Upgrade Mattermost</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#mattermost-integrations">Mattermost Integrations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#mattermost-compliance">Mattermost Compliance</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../guides/administrator.html#scaling-mattermost">Scaling Mattermost</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="scaling.html">Scaling for Enterprise</a></li>
<li class="toctree-l3"><a class="reference internal" href="cluster.html">High Availability Cluster (E20)</a></li>
<li class="toctree-l3"><a class="reference internal" href="cluster-310.html">High Availability Cluster (v3.10 and earlier)</a></li>
<li class="toctree-l3"><a class="reference internal" href="elasticsearch.html">Elasticsearch (E20)</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Performance Monitoring (E20)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#deployment-guide">Deployment Guide</a></li>
<li class="toctree-l4"><a class="reference internal" href="#getting-started">Getting Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="#statistics">Statistics</a></li>
<li class="toctree-l4"><a class="reference internal" href="#frequently-asked-questions">Frequently Asked Questions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../administration/performance-alerting-guide.html">Mattermost Performance Alerting Guide</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#community-managed-documentation">Community-Managed Documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../guides/user.html">User's Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/integration.html">Integration Guide</a></li>
<li class="toctree-l1"><a class="reference external" href="https://developers.mattermost.com/">Developer's Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Mattermost</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          


  


<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
    
      <li><a href="../guides/administrator.html">Self-Managed Administrator’s Guide</a> &raquo;</li>
    
    <li>Performance Monitoring (E20)</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/mattermost/docs/blob/master/source/deployment/metrics.rst" class="fa fa-github"> Edit</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="performance-monitoring-e20">
<h1><a class="toc-backref" href="#contents">Performance Monitoring (E20)</a><a class="headerlink" href="#performance-monitoring-e20" title="Permalink to this headline">¶</a></h1>
<p><em>Available in Enterprise Edition E20</em>.</p>
<p>Performance monitoring support enables a Mattermost server to track system health for large Enterprise deployments through integrations with <a class="reference external" href="https://prometheus.io/">Prometheus</a> and <a class="reference external" href="https://grafana.org/">Grafana</a>.</p>
<p>The integration supports data collection from several Mattermost servers, particularly useful if you’re running Mattermost <a class="reference external" href="https://docs.mattermost.com/deployment/cluster.html">in high availability mode</a>.</p>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#performance-monitoring-e20" id="id1">Performance Monitoring (E20)</a><ul>
<li><a class="reference internal" href="#deployment-guide" id="id2">Deployment Guide</a><ul>
<li><a class="reference internal" href="#installing-prometheus" id="id3">Installing Prometheus</a></li>
<li><a class="reference internal" href="#installing-grafana" id="id4">Installing Grafana</a></li>
</ul>
</li>
<li><a class="reference internal" href="#getting-started" id="id5">Getting Started</a></li>
<li><a class="reference internal" href="#statistics" id="id6">Statistics</a><ul>
<li><a class="reference internal" href="#custom-mattermost-metrics" id="id7">Custom Mattermost Metrics</a></li>
<li><a class="reference internal" href="#standard-go-metrics" id="id8">Standard GO Metrics</a></li>
</ul>
</li>
<li><a class="reference internal" href="#frequently-asked-questions" id="id9">Frequently Asked Questions</a><ul>
<li><a class="reference internal" href="#why-are-chart-labels-difficult-to-distinguish" id="id10">Why Are Chart Labels Difficult To Distinguish?</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="deployment-guide">
<h2><a class="toc-backref" href="#contents">Deployment Guide</a><a class="headerlink" href="#deployment-guide" title="Permalink to this headline">¶</a></h2>
<p>Details on integrating your Mattermost server with Prometheus and Grafana.</p>
<div class="section" id="installing-prometheus">
<h3><a class="toc-backref" href="#contents">Installing Prometheus</a><a class="headerlink" href="#installing-prometheus" title="Permalink to this headline">¶</a></h3>
<p>1 - <a class="reference external" href="https://prometheus.io/download/">Download a precompiled binary for Prometheus</a>. Binaries are provided for many popular distributions, including Darwin, Linux and Windows.</p>
<p>For install instructions, see <a class="reference external" href="https://prometheus.io/docs/introduction/getting_started/">Prometheus install guides</a>.</p>
<p>2 - The following settings are recommended in the Prometheus configuration file named <code class="docutils literal notranslate"><span class="pre">prometheus.yml</span></code>:</p>
<div class="code yaml highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># my global config</span>
<span class="k">global</span><span class="p">:</span>
  <span class="n">scrape_interval</span><span class="p">:</span>     <span class="mi">60</span><span class="n">s</span> <span class="c1"># By default, scrape targets every 15 seconds.</span>
  <span class="n">evaluation_interval</span><span class="p">:</span> <span class="mi">60</span><span class="n">s</span> <span class="c1"># By default, scrape targets every 15 seconds.</span>
  <span class="c1"># scrape_timeout is set to the global default (10s).</span>

  <span class="c1"># Attach these labels to any time series or alerts when communicating with</span>
  <span class="c1"># external systems (federation, remote storage, Alertmanager).</span>
  <span class="n">external_labels</span><span class="p">:</span>
      <span class="n">monitor</span><span class="p">:</span> <span class="s1">&#39;mattermost-monitor&#39;</span>

<span class="c1"># Load rules once and periodically evaluate them according to the global &#39;evaluation_interval&#39;.</span>
<span class="n">rule_files</span><span class="p">:</span>
  <span class="c1"># - &quot;first.rules&quot;</span>
  <span class="c1"># - &quot;second.rules&quot;</span>

<span class="c1"># A scrape configuration containing exactly one endpoint to scrape:</span>
<span class="c1"># Here it&#39;s Prometheus itself.</span>
<span class="n">scrape_configs</span><span class="p">:</span>
  <span class="c1"># The job name is added as a label `job=&lt;job_name&gt;` to any timeseries scraped from this config.</span>
  <span class="o">-</span> <span class="n">job_name</span><span class="p">:</span> <span class="s1">&#39;prometheus&#39;</span>

    <span class="c1"># Override the global default and scrape targets from this job every 5 seconds.</span>
    <span class="c1"># scrape_interval: 5s</span>

    <span class="c1"># metrics_path defaults to &#39;/metrics&#39;</span>
    <span class="c1"># scheme defaults to &#39;http&#39;.</span>

    <span class="n">static_configs</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">targets</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;hostname1&gt;:&lt;port&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;hostname2&gt;:&lt;port&gt;&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">&lt;hostname1&gt;:&lt;port&gt;</span></code> parameter has to be replaced with your Mattermost host ip address and port to scrape the data. It connects to <code class="docutils literal notranslate"><span class="pre">/metrics</span></code> using http.</p>
<p>3 - Enable performance monitoring in the Mattermost System Console and specify the listen address. See more detail in our <a class="reference external" href="https://docs.mattermost.com/administration/config-settings.html#performance-monitoring-beta">configuration settings documentation</a>. After enabling performance monitoring, make sure to reboot Mattermost.</p>
<a class="reference internal image-reference" href="../_images/perf_monitoring_system_console.png"><img alt="../_images/perf_monitoring_system_console.png" src="../_images/perf_monitoring_system_console.png" style="width: 627.9px; height: 283.5px;" /></a>
<p>4 - To test the server is running, go to <code class="docutils literal notranslate"><span class="pre">&lt;ip&gt;:&lt;port&gt;/metrics</span></code>.</p>
<p>5 - Finally, run <code class="docutils literal notranslate"><span class="pre">vi</span> <span class="pre">prometheus.yml</span></code> to finish configuring Prometheus.</p>
<p>For starting the Prometheus service, read the <a class="reference external" href="https://prometheus.io/docs/introduction/getting_started/#starting-prometheus">comprehensive guides provided by Prometheus</a>.</p>
<p>6 - Once the service has started, you can access the data in <code class="docutils literal notranslate"><span class="pre">&lt;localhost&gt;:&lt;port&gt;/graph</span></code>.</p>
<p>While you can use the Prometheus service to create graphs, we’ll focus on creating metric and analytics dashboards in Grafana.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For troubleshooting advice, check the <a class="reference external" href="https://prometheus.io/docs/introduction/faq/">Prometheus FAQ page</a>.</p>
</div>
</div>
<div class="section" id="installing-grafana">
<h3><a class="toc-backref" href="#contents">Installing Grafana</a><a class="headerlink" href="#installing-grafana" title="Permalink to this headline">¶</a></h3>
<p>1 - <a class="reference external" href="https://docs.grafana.org/installation/debian/">Download a precompiled binary for Grafana</a> on Ubuntu or Debian. Binaries are also available for other distributions, including Redhat, Windows and Mac.</p>
<p>For install instructions, see <a class="reference external" href="https://docs.grafana.org/installation/debian/">Grafana install guides</a></p>
<p>2 - The Grafana package is installed as a service, so it is easy to start the server. See their <a class="reference external" href="https://docs.grafana.org/installation/debian/">install guides</a> to learn more.</p>
<p>3 - The default HTTP port is <code class="docutils literal notranslate"><span class="pre">3000</span></code> and default username and password are <code class="docutils literal notranslate"><span class="pre">admin</span></code>.</p>
<p>4 - A Mattermost data source should be added, with settings defined in the screenshot below.</p>
<img alt="../_images/mattermost_datasource.png" src="../_images/mattermost_datasource.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For troubleshooting advice, check the <a class="reference external" href="https://docs.grafana.org/installation/troubleshooting/">Grafana Troubleshooting page</a>.</p>
</div>
<p>For user guides and tutorials, check the <a class="reference external" href="https://docs.grafana.org/guides/basic_concepts/">Grafana documentation to learn more</a>.</p>
</div>
</div>
<div class="section" id="getting-started">
<h2><a class="toc-backref" href="#contents">Getting Started</a><a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>To help you get started, you can download three sample dashboards shared in Grafana:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://grafana.com/dashboards/2539">Mattermost Performance KPI Metrics</a>, which contains key metrics for monitoring performance and system health.</li>
<li><a class="reference external" href="https://grafana.com/dashboards/2542">Mattermost Performance Monitoring</a>, which contains detailed charts for performance monitoring.</li>
<li><a class="reference external" href="https://grafana.com/dashboards/2545">Mattermost Performance Monitoring (Bonus Metrics)</a>, which contains additional metrics such as emails sent or files uploaded, which may be important to monitor in some deployments.</li>
</ul>
</div></blockquote>
<p>See <a class="reference external" href="https://docs.grafana.org/reference/export_import/">this guide</a> to learn how to import Grafana dashboards either from the UI or from the HTTP API.</p>
</div>
<div class="section" id="statistics">
<h2><a class="toc-backref" href="#contents">Statistics</a><a class="headerlink" href="#statistics" title="Permalink to this headline">¶</a></h2>
<p>Mattermost provides the following performance monitoring statistics to integrate with Prometheus and Grafana.</p>
<div class="section" id="custom-mattermost-metrics">
<h3><a class="toc-backref" href="#contents">Custom Mattermost Metrics</a><a class="headerlink" href="#custom-mattermost-metrics" title="Permalink to this headline">¶</a></h3>
<p>The following is a list of custom Mattermost metrics that can be used to monitor your system’s performance:</p>
<p>API Metrics:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">mattermost_api_time</span></code>: The total time in seconds to execute a given API handler.</li>
</ul>
</div></blockquote>
<p>Caching Metrics:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">mattermost_cache_etag_hit_total</span></code>: The total number of ETag cache hits for a specific cache.</li>
<li><code class="docutils literal notranslate"><span class="pre">mattermost_cache_etag_miss_total</span></code>: The total number of ETag cache misses for an API call.</li>
<li><code class="docutils literal notranslate"><span class="pre">mattermost_cache_mem_hit_total</span></code>: The total number of memory cache hits for a specific cache.</li>
<li><code class="docutils literal notranslate"><span class="pre">mattermost_cache_mem_invalidation_total</span></code>: The total number of memory cache invalidations for a specific cache.</li>
<li><code class="docutils literal notranslate"><span class="pre">mattermost_cache_mem_miss_total</span></code>: The total number of cache misses for a specific cache.</li>
</ul>
</div></blockquote>
<p>The above metrics can be used to calculate ETag and memory cache hit rates over time.</p>
<img alt="../_images/perf_monitoring_caching_metrics.png" src="../_images/perf_monitoring_caching_metrics.png" />
<p>Cluster Metrics:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">mattermost_cluster_cluster_request_duration_seconds</span></code>:  The total duration in seconds of the inter-node cluster requests.</li>
<li><code class="docutils literal notranslate"><span class="pre">mattermost_cluster_cluster_requests_total</span></code>: The total number of inter-node requests.</li>
<li><code class="docutils literal notranslate"><span class="pre">mattermost_cluster_event_type_totals</span></code>: The total number of cluster requests sent for any type.</li>
</ul>
</div></blockquote>
<p>Database Metrics:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">mattermost_db_master_connections_total</span></code>: The total number of connections to the master database.</li>
<li><code class="docutils literal notranslate"><span class="pre">mattermost_db_read_replica_connections_total</span></code>: The total number of connections to all the read replica databases.</li>
<li><code class="docutils literal notranslate"><span class="pre">mattermost_db_search_replica_connections_total</span></code>: The total number of connections to all the search replica databases.</li>
<li><code class="docutils literal notranslate"><span class="pre">mattermost_db_store_time</span></code>: The total time in seconds to execute a given database store method.</li>
</ul>
</div></blockquote>
<p>HTTP Metrics:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">mattermost_http_errors_total</span></code>: The total number of http API errors.</li>
<li><code class="docutils literal notranslate"><span class="pre">mattermost_http_request_duration_seconds</span></code>: The total duration in seconds of the http API requests.</li>
<li><code class="docutils literal notranslate"><span class="pre">mattermost_http_requests_total</span></code>: The total number of http API requests.</li>
</ul>
</div></blockquote>
<img alt="../_images/perf_monitoring_http_metrics.png" src="../_images/perf_monitoring_http_metrics.png" />
<p>Login and Session Metrics:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">mattermost_http_websockets_total</span></code> The total number of WebSocket connections to the server.</li>
<li><code class="docutils literal notranslate"><span class="pre">mattermost_login_logins_fail_total</span></code>: The total number of failed logins.</li>
<li><code class="docutils literal notranslate"><span class="pre">mattermost_login_logins_total</span></code>: The total number of successful logins.</li>
</ul>
</div></blockquote>
<p>Messaging Metrics:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">mattermost_post_broadcasts_total</span></code>: The total number of WebSocket broadcasts sent because a post was created.</li>
<li><code class="docutils literal notranslate"><span class="pre">mattermost_post_emails_sent_total</span></code>: The total number of emails sent because a post was created.</li>
<li><code class="docutils literal notranslate"><span class="pre">mattermost_post_file_attachments_total</span></code>: The total number of file attachments created because a post was created.</li>
<li><code class="docutils literal notranslate"><span class="pre">mattermost_post_pushes_sent_total</span></code>: The total number of mobile push notifications sent because a post was created.</li>
<li><code class="docutils literal notranslate"><span class="pre">mattermost_post_total</span></code>: The total number of posts created.</li>
<li><code class="docutils literal notranslate"><span class="pre">mattermost_post_webhooks_totals</span></code>: The total number of webhook posts created.</li>
</ul>
</div></blockquote>
<img alt="../_images/perf_monitoring_messaging_metrics.png" src="../_images/perf_monitoring_messaging_metrics.png" />
<p>Process Metrics:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">mattermost_process_cpu_seconds_total</span></code>: Total user and system CPU time spent in seconds.</li>
<li><code class="docutils literal notranslate"><span class="pre">mattermost_process_max_fds</span></code>: Maximum number of open file descriptors.</li>
<li><code class="docutils literal notranslate"><span class="pre">mattermost_process_open_fds</span></code>: Number of open file descriptors.</li>
<li><code class="docutils literal notranslate"><span class="pre">mattermost_process_resident_memory_bytes</span></code>: Resident memory size in bytes.</li>
<li><code class="docutils literal notranslate"><span class="pre">mattermost_process_start_time_seconds</span></code>: Start time of the process since unix epoch in seconds.</li>
<li><code class="docutils literal notranslate"><span class="pre">mattermost_process_virtual_memory_bytes</span></code>: Virtual memory size in bytes.</li>
</ul>
</div></blockquote>
<p>Search Metrics:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">mattermost_search_posts_searches_duration_seconds_sum</span></code>: The total duration, in seconds, of search query requests.</li>
<li><code class="docutils literal notranslate"><span class="pre">mattermost_search_posts_searches_duration_seconds_count</span></code>: The total number of search query requests.</li>
</ul>
</div></blockquote>
<p>WebSocket Metrics:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">mattermost_websocket_broadcasts_total</span></code>: The total number of WebSocket broadcasts sent by type.</li>
<li><code class="docutils literal notranslate"><span class="pre">mattermost_websocket_event_total</span></code>: The total number of WebSocket events sent by type.</li>
</ul>
</div></blockquote>
<p>Logging Metrics:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">logger_queue_used</span></code>: Current logging queue level(s).</li>
<li><code class="docutils literal notranslate"><span class="pre">logger_logged_total</span></code>: The total number of logging records emitted.</li>
<li><code class="docutils literal notranslate"><span class="pre">logger_error_total</span></code>: The total number of logging errors.</li>
<li><code class="docutils literal notranslate"><span class="pre">logger_dropped_total</span></code>: The total number of logging records dropped.</li>
<li><code class="docutils literal notranslate"><span class="pre">logger_blocked_total</span></code>: The total number of logging records blocked.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="standard-go-metrics">
<h3><a class="toc-backref" href="#contents">Standard GO Metrics</a><a class="headerlink" href="#standard-go-metrics" title="Permalink to this headline">¶</a></h3>
<p>The Prometheus integration also provides standard GO metrics for HTTP server runtime profiling data and system monitoring, such as:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">go_memstats_alloc_bytes</span></code> for memory usage</li>
<li><code class="docutils literal notranslate"><span class="pre">go_goroutines</span></code> for GO routines</li>
<li><code class="docutils literal notranslate"><span class="pre">go_gc_duration_seconds</span></code> for garbage collection duration</li>
<li><code class="docutils literal notranslate"><span class="pre">go_memstats_heap_objects</span></code> for object tracking on the heap</li>
</ul>
</div></blockquote>
<p>To learn how to set up runtime profiling, see the <a class="reference external" href="https://golang.org/pkg/net/http/pprof/">pprof package GO documentation</a>.  You can also visit the <code class="docutils literal notranslate"><span class="pre">ip:port/metrics</span></code> page for a complete list of metrics with descriptions.</p>
<p>If enabled, you can run the profiler by</p>
<blockquote>
<div><code class="docutils literal notranslate"><span class="pre">go</span> <span class="pre">tool</span> <span class="pre">pprof</span> <span class="pre">channel</span> <span class="pre">http://localhost:&lt;port&gt;/debug/pprof/profile</span></code></div></blockquote>
<p>where you can replace <code class="docutils literal notranslate"><span class="pre">localhost</span></code> with the server name. The profiling reports are available at <code class="docutils literal notranslate"><span class="pre">&lt;ip&gt;:&lt;port&gt;</span></code>, which include:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">/debug/pprof/</span></code> for CPU profiling</li>
<li><code class="docutils literal notranslate"><span class="pre">/debug/pprof/cmdline/</span></code> for command line profiling</li>
<li><code class="docutils literal notranslate"><span class="pre">/debug/pprof/symbol/</span></code> for symbol profiling</li>
<li><code class="docutils literal notranslate"><span class="pre">/debug/pprof/goroutine/</span></code> for GO routine profiling</li>
<li><code class="docutils literal notranslate"><span class="pre">/debug/pprof/heap/</span></code> for heap profiling</li>
<li><code class="docutils literal notranslate"><span class="pre">/debug/pprof/threadcreate/</span></code> for threads profiling</li>
<li><code class="docutils literal notranslate"><span class="pre">/debug/pprof/block/</span></code> for block profiling</li>
</ul>
</div></blockquote>
<img alt="../_images/perf_monitoring_go_metrics.png" src="../_images/perf_monitoring_go_metrics.png" />
</div>
</div>
<div class="section" id="frequently-asked-questions">
<h2><a class="toc-backref" href="#contents">Frequently Asked Questions</a><a class="headerlink" href="#frequently-asked-questions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="why-are-chart-labels-difficult-to-distinguish">
<h3><a class="toc-backref" href="#contents">Why Are Chart Labels Difficult To Distinguish?</a><a class="headerlink" href="#why-are-chart-labels-difficult-to-distinguish" title="Permalink to this headline">¶</a></h3>
<p>The chart labels used in server filters and legends are based on the hostname of your machines. If the hostnames are similar, then it will be difficult to distinguish the labels.</p>
<p>You can either set more descriptive hostnames for your machines or change the display name with a <code class="docutils literal notranslate"><span class="pre">relabel_config</span></code> in  <a class="reference external" href="https://prometheus.io/docs/prometheus/latest/configuration/configuration/#relabel_config">Prometheus configuration</a>.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../administration/performance-alerting-guide.html" class="btn btn-neutral float-right" title="Mattermost Performance Alerting Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="elasticsearch.html" class="btn btn-neutral" title="Elasticsearch (E20)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2020 Mattermost

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
 




<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-cog">&nbsp;&nbsp;Options</span>&nbsp;
        <span class="fa fa-angle-up"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Contribute</dt>
            <dd>
                <a href="https://github.com/mattermost/docs/issues">Report a Problem</a>
            </dd>
            
            <dd>
                <a href="https://github.com/mattermost/docs/blob/master/source/deployment/metrics.rst"> Edit on GitHub</a>
            </dd>
            
        </dl>
    </div>
</div>


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../_static/myscript.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
	<header>
	<div class="header__container">
		<div class="search__icon">
			<i class="fa fa-search"></i>
		</div>
		<a href="https://docs.mattermost.com/" class="header__logo">
			<img width="176" src="https://about.mattermost.com/wp-content/uploads/2017/08/Mattermost-Logo-Blue.svg">
		</a>
		<div class="links__icon">
			<i class="fa fa-bars"></i>
		</div>
		<ul class="header__links">
			<li><a href="https://developers.mattermost.com/">Developers</a></li>
			<li><a href="https://mattermost.com/features/">Product</a></li>
			<li><a href="https://mattermost.com/pricing/">Pricing</a></li>
			<li><a href="https://mattermost.com/blog/">Blog</a></li>
			<li><a href="https://mattermost.com/download/">Download</a></li>
			<li><a href="https://mattermost.com/trial/">Trial</a></li>
		</ul>
		<div class="header__searchbar">
			<form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
                <input type="text" name="q" placeholder="Search by keyword" autofocus />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
		</div>
	</div>
</header>
	<script type="text/javascript">
		/* Temporary fix for the search capability. Fix has been committed to the theme's master;
		   however, waiting a new release to the theme.  This fix should remain in place until that
		   time.  sphinx_rtd_theme is current v0.1.10a0. Commit for the fix in the
		   theme can be found at: https://github.com/snide/sphinx_rtd_theme/commit/a5e0e304
		 */
        if(DOCUMENTATION_OPTIONS) {
			DOCUMENTATION_OPTIONS.SOURCELINK_SUFFIX = '.txt'
        }
    </script>


</body>
</html>