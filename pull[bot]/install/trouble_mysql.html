


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>MySQL Installation Troubleshooting &mdash; Mattermost 5.31 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme.css" type="text/css" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Upgrading Mattermost Server" href="../administration/upgrade.html" />
    <link rel="prev" title="Important Notes" href="troubleshooting.html" />
	<!-- Google Tag Manager -->
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-K874RWM');</script>
	<!-- End Google Tag Manager -->


  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Mattermost
          

          
          </a>

          
            
            
              <div class="version">
                5.31
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/cloud-admin-guide.html">Cloud Administrator's Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../guides/administrator.html">Self-Managed Administrator's Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview/architecture.html">Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deployment/deployment.html">Deployment Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#installing-mattermost">Installing Mattermost</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#deployment">Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#configure-mattermost">Configure Mattermost</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#incident-management">Incident Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#mobile-apps">Mobile Apps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#onboard-users">Onboard Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#administration">Administration</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../guides/administrator.html#troubleshooting">Troubleshooting</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html">Important Notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#general-troubleshooting">General Troubleshooting</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#administration-issues">Administration Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#saml-issues">SAML issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#deployment-and-clustering">Deployment and Clustering</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#server-administration">Server Administration</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#settings">Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#mobile">Mobile</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#configuration-issues">Configuration Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="troubleshooting.html#none-of-these-solve-my-problem">None of These Solve my Problem!</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">MySQL Installation Troubleshooting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-mattermost-database">The <code class="docutils literal notranslate"><span class="pre">mattermost</span></code> Database</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-database-user">The Database User</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-user-password">The User Password</a></li>
<li class="toctree-l4"><a class="reference internal" href="#insufficient-user-privileges">Insufficient User Privileges</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#upgrade-mattermost">Upgrade Mattermost</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#mattermost-integrations">Mattermost Integrations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#mattermost-compliance">Mattermost Compliance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#scaling-mattermost">Scaling Mattermost</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/administrator.html#community-managed-documentation">Community-Managed Documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../guides/user.html">User's Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/integration.html">Integration Guide</a></li>
<li class="toctree-l1"><a class="reference external" href="https://developers.mattermost.com/">Developer's Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Mattermost</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          


  


<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
    
      <li><a href="../guides/administrator.html">Self-Managed Administrator’s Guide</a> &raquo;</li>
    
    <li>MySQL Installation Troubleshooting</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/mattermost/docs/blob/master/source/install/trouble_mysql.rst" class="fa fa-github"> Edit</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="mysql-installation-troubleshooting">
<h1>MySQL Installation Troubleshooting<a class="headerlink" href="#mysql-installation-troubleshooting" title="Permalink to this headline">¶</a></h1>
<p>Before you can run the Mattermost server, you must first install and configure a database. You can start Mattermost by navigating to the <code class="docutils literal notranslate"><span class="pre">/opt/mattermost</span></code> directory and entering the command
<code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">-u</span> <span class="pre">mattermost</span> <span class="pre">bin/mattermost</span></code>. If the Mattermost server cannot connect to the database, it will fail to start. This section deals with MySQL database issues that you may encounter when you start up Mattermost for the first time.</p>
<p>How you install MySQL varies depending upon which Linux distribution you use. However, once MySQL is installed, the configuration instructions are the
same. For all distributions you must create a <code class="docutils literal notranslate"><span class="pre">mattermost</span></code> database and a <code class="docutils literal notranslate"><span class="pre">mattermost</span></code> database user. Failure to create these database
objects or improperly referencing them from the Mattermost configuration file, <code class="docutils literal notranslate"><span class="pre">/opt/mattermost/config/config.json</span></code>, causes Mattermost to fail. The troubleshooting tips given here deal with these specific issues.</p>
<p>Before proceeding, confirm that your MySQL server is running. You can do this by issuing the command <code class="docutils literal notranslate"><span class="pre">mysqladmin</span> <span class="pre">-u</span> <span class="pre">root</span> <span class="pre">-p</span> <span class="pre">status</span></code>. When
prompted, enter your password. If MySQL is running you should see output like the following:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Uptime</span><span class="p">:</span> <span class="mi">877134</span>  <span class="n">Threads</span><span class="p">:</span> <span class="mi">1</span>  <span class="n">Questions</span><span class="p">:</span> <span class="mi">9902</span>  <span class="n">Slow</span> <span class="n">queries</span><span class="p">:</span> <span class="mi">0</span>  <span class="n">Opens</span><span class="p">:</span> <span class="mi">522</span>
<span class="n">Flush</span> <span class="n">tables</span><span class="p">:</span> <span class="mi">1</span>  <span class="n">Open</span> <span class="n">tables</span><span class="p">:</span> <span class="mi">371</span>  <span class="n">Queries</span> <span class="n">per</span> <span class="n">second</span> <span class="n">avg</span><span class="p">:</span> <span class="mf">0.011</span>
</pre></div>
</div>
</div></blockquote>
<p>If MySQL is not running, review the instructions for installation on your distribution.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Some of the commands used in this section alter the database. <strong>Use these commands only if your Mattermost installation has failed.</strong> Do not directly manipulate the MySQL database for a working Mattermost installation.</p>
</div>
<div class="section" id="the-mattermost-database">
<h2>The <code class="docutils literal notranslate"><span class="pre">mattermost</span></code> Database<a class="headerlink" href="#the-mattermost-database" title="Permalink to this headline">¶</a></h2>
<p>The database created during installation is named <code class="docutils literal notranslate"><span class="pre">mattermost</span></code>. If you fail to create this database or you misname it, you will see an error such as the following when you attempt to start the Mattermost server:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">2017</span><span class="o">/</span><span class="mi">09</span><span class="o">/</span><span class="mi">20</span> <span class="mi">17</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">37</span> <span class="n">EDT</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">Pinging</span> <span class="n">SQL</span> <span class="n">master</span> <span class="n">database</span>
<span class="p">[</span><span class="mi">2017</span><span class="o">/</span><span class="mi">09</span><span class="o">/</span><span class="mi">20</span> <span class="mi">17</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">37</span> <span class="n">EDT</span><span class="p">]</span> <span class="p">[</span><span class="n">EROR</span><span class="p">]</span> <span class="n">Failed</span> <span class="n">to</span> <span class="n">ping</span> <span class="n">DB</span> <span class="n">retrying</span> <span class="ow">in</span> <span class="mi">10</span> <span class="n">seconds</span>
<span class="n">err</span><span class="o">-</span><span class="n">Error</span> <span class="mi">1044</span><span class="p">:</span> <span class="n">Access</span> <span class="n">denied</span> <span class="k">for</span> <span class="n">user</span> <span class="s1">&#39;mmuser&#39;</span><span class="o">@</span><span class="s1">&#39;%&#39;</span> <span class="n">to</span> <span class="n">database</span> <span class="s1">&#39;mattermost&#39;</span>
</pre></div>
</div>
</div></blockquote>
<p>Note that MySQL is specifically denying access to the <code class="docutils literal notranslate"><span class="pre">mattermost</span></code> database. This may mean that you have failed to create a database named
<code class="docutils literal notranslate"><span class="pre">mattermost</span></code> or you may have incorrectly referenced this database from the <code class="docutils literal notranslate"><span class="pre">/opt/mattermost/config/config.json</span></code> file.</p>
<p><strong>Checking that the Database Exists</strong></p>
<p>To confirm that the <code class="docutils literal notranslate"><span class="pre">mattermost</span></code> database exists, open MySQL as <em>root</em> by executing <code class="docutils literal notranslate"><span class="pre">mysql</span> <span class="pre">-u</span> <span class="pre">root</span> <span class="pre">-p</span></code>. When prompted, enter your password and then issue the command <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">databases;</span></code>. This command displays all the databases. You should see something similar to the following:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+--------------------+</span>
<span class="o">|</span> <span class="n">Database</span>           <span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="o">|</span> <span class="n">information_schema</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">mattermost</span>         <span class="o">|</span>
<span class="o">|</span> <span class="n">mysql</span>              <span class="o">|</span>
<span class="o">|</span> <span class="n">performance_schema</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">sys</span>                <span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="mi">5</span> <span class="n">rows</span> <span class="ow">in</span> <span class="nb">set</span> <span class="p">(</span><span class="mf">0.03</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>No mattermost Database</strong></p>
<p>If the <code class="docutils literal notranslate"><span class="pre">mattermost</span></code> database doesn’t exist, create a database named <code class="docutils literal notranslate"><span class="pre">mattermost</span></code> by opening MySQL as root and issuing the command: <code class="docutils literal notranslate"><span class="pre">create</span> <span class="pre">database</span> <span class="pre">mattermost;</span></code>.</p>
<p>If you accidentally created a database with the wrong name, you can remove it by issuing the command: <code class="samp docutils literal notranslate"><span class="pre">drop</span> <span class="pre">database</span> <em><span class="pre">misnamed</span></em><span class="pre">;</span></code>.</p>
<p>After creating the database, attempt to restart the Mattermost server by navigating to the <code class="docutils literal notranslate"><span class="pre">/opt/mattermost</span></code> directory and entering the command <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">-u</span> <span class="pre">mattermost</span> <span class="pre">bin/mattermost</span></code>.</p>
<p><strong>The mattermost Database Exists</strong></p>
<p>If the <code class="docutils literal notranslate"><span class="pre">mattermost</span></code> database does exist, confirm that you have defined the database driver correctly in the <code class="docutils literal notranslate"><span class="pre">/opt/mattermost/config/config.json</span></code> file. Open this file in a text editor, and review the value of <code class="docutils literal notranslate"><span class="pre">&quot;DataSource&quot;</span></code>. It should be:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;mmuser:*mmuser-password*@tcp(*host-name-or-IP*:3306)/mattermost?charset=utf8mb4,utf8&amp;readTimeout=30s&amp;writeTimeout=30s&quot;</span>
</pre></div>
</div>
</div></blockquote>
<p>You should also confirm that <code class="docutils literal notranslate"><span class="pre">DriverName</span></code> element (found immediately above the <code class="docutils literal notranslate"><span class="pre">DataSource</span></code> element) is set to <code class="docutils literal notranslate"><span class="pre">mysql</span></code>.</p>
<p>If you correct an error, restart the Mattermost server by navigating to the <code class="docutils literal notranslate"><span class="pre">/opt/mattermost</span></code> directory and entering the command <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">-u</span> <span class="pre">mattermost</span> <span class="pre">bin/mattermost</span></code>.</p>
</div>
<div class="section" id="the-database-user">
<h2>The Database User<a class="headerlink" href="#the-database-user" title="Permalink to this headline">¶</a></h2>
<p>During the installation you should create a MySQL database user from the <em>mysql</em> prompt by issuing the command</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">samp:</th><td class="field-body"><cite>create user ‘mmuser’&#64;’%’ identified by ‘{mmuser-password}’;</cite>.</td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal notranslate"><span class="pre">mmuser-password</span></code> value is a placeholder for the password you chose. You may also have specified an IP address rather than the wild card
<code class="docutils literal notranslate"><span class="pre">%</span></code>.</p>
<p>A MySQL user is fully defined by their username and the host that they access MySQL from. These elements are separated by the <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> sign. The <code class="docutils literal notranslate"><span class="pre">%</span></code> character is a wild card indicating that the user can access MySQL from any IP address. If the user you created accesses MySQL from a specific IP address such as <code class="docutils literal notranslate"><span class="pre">10.10.10.2</span></code>, please adjust your actions accordingly.</p>
<p>If the user and host combination that you created does not exist, you will see an error such as:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">2017</span><span class="o">/</span><span class="mi">09</span><span class="o">/</span><span class="mi">20</span> <span class="mi">17</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mi">18</span> <span class="n">EDT</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">Pinging</span> <span class="n">SQL</span> <span class="n">master</span> <span class="n">database</span>
<span class="p">[</span><span class="mi">2017</span><span class="o">/</span><span class="mi">09</span><span class="o">/</span><span class="mi">20</span> <span class="mi">17</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mi">18</span> <span class="n">EDT</span><span class="p">]</span> <span class="p">[</span><span class="n">EROR</span><span class="p">]</span> <span class="n">Failed</span> <span class="n">to</span> <span class="n">ping</span> <span class="n">DB</span> <span class="n">retrying</span> <span class="ow">in</span> <span class="mi">10</span> <span class="n">seconds</span>
<span class="n">err</span><span class="o">-</span><span class="n">Error</span> <span class="mi">1045</span><span class="p">:</span> <span class="n">Access</span> <span class="n">denied</span> <span class="k">for</span> <span class="n">user</span> <span class="s1">&#39;mmuser&#39;</span><span class="o">@</span><span class="s1">&#39;localhost&#39;</span> <span class="p">(</span><span class="n">using</span> <span class="n">password</span><span class="p">:</span> <span class="n">YES</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Checking that mmuser Exists</strong></p>
<p>To check that this user exists, log in to MySQL as <em>root</em>: <code class="docutils literal notranslate"><span class="pre">mysql</span> <span class="pre">-u</span> <span class="pre">root</span> <span class="pre">-p</span></code>.</p>
<p>When prompted, enter the root password that you created when installing MySQL. From the <code class="docutils literal notranslate"><span class="pre">mysql</span></code> prompt enter the command <code class="docutils literal notranslate"><span class="pre">select</span> <span class="pre">User,</span> <span class="pre">Host</span> <span class="pre">from</span> <span class="pre">mysql.user;</span></code>. You should see something like the following:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+------------------+-----------+</span>
<span class="o">|</span> <span class="n">User</span>             <span class="o">|</span> <span class="n">Host</span>      <span class="o">|</span>
<span class="o">+------------------+-----------+</span>
<span class="o">|</span> <span class="n">mmuser</span>           <span class="o">|</span> <span class="o">%</span>         <span class="o">|</span>
<span class="o">|</span> <span class="n">debian</span><span class="o">-</span><span class="n">sys</span><span class="o">-</span><span class="n">maint</span> <span class="o">|</span> <span class="n">localhost</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">mysql</span><span class="o">.</span><span class="n">session</span>    <span class="o">|</span> <span class="n">localhost</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">mysql</span><span class="o">.</span><span class="n">sys</span>        <span class="o">|</span> <span class="n">localhost</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">root</span>             <span class="o">|</span> <span class="n">localhost</span> <span class="o">|</span>
<span class="o">+------------------+-----------+</span>
<span class="mi">5</span> <span class="n">rows</span> <span class="ow">in</span> <span class="nb">set</span> <span class="p">(</span><span class="mf">0.00</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>User Doesn’t Exist</strong></p>
<p>If <code class="docutils literal notranslate"><span class="pre">'mmuser'&#64;'%'</span></code> does not exist, create this user by logging into MySQL as <em>root</em> and issuing the command:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">samp:</th><td class="field-body"><cite>create user ‘mmuser’&#64;’%’ identified by ‘{mmuser-password}’;</cite>.</td>
</tr>
</tbody>
</table>
<p>After creating a user, ensure that this user has rights to the <code class="docutils literal notranslate"><span class="pre">mattermost</span></code> database by following the instructions given in <span class="xref std std-ref">mysql_grants</span>.</p>
<p><strong>User Exists</strong></p>
<p>If the user <code class="docutils literal notranslate"><span class="pre">mmuser</span></code> exists, the DataSource element of the <code class="docutils literal notranslate"><span class="pre">/opt/mattermost/config/config.json</span></code> file may be incorrect. Open this file and search for <code class="docutils literal notranslate"><span class="pre">DataSource</span></code>. Its value should be:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;mmuser:*mmuser-password*@tcp(*host-name-or-IP*:3306)/mattermost?charset=utf8mb4,utf8&amp;readTimeout=30s&amp;writeTimeout=30s&quot;</span>
</pre></div>
</div>
</div></blockquote>
<p>If you correct an error, restart the Mattermost server by navigating to the <code class="docutils literal notranslate"><span class="pre">/opt/mattermost</span></code> directory and issuing the command: <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">-u</span> <span class="pre">mattermost</span> <span class="pre">bin/mattermost</span></code>.</p>
</div>
<div class="section" id="the-user-password">
<h2>The User Password<a class="headerlink" href="#the-user-password" title="Permalink to this headline">¶</a></h2>
<p>Mattermost will fail if you use an incorrect password for <code class="docutils literal notranslate"><span class="pre">mmuser</span></code>. An incorrect password displays an error message such as the following:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">2017</span><span class="o">/</span><span class="mi">09</span><span class="o">/</span><span class="mi">20</span> <span class="mi">17</span><span class="p">:</span><span class="mi">09</span><span class="p">:</span><span class="mi">10</span> <span class="n">EDT</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">Pinging</span> <span class="n">SQL</span> <span class="n">master</span> <span class="n">database</span>
<span class="p">[</span><span class="mi">2017</span><span class="o">/</span><span class="mi">09</span><span class="o">/</span><span class="mi">20</span> <span class="mi">17</span><span class="p">:</span><span class="mi">09</span><span class="p">:</span><span class="mi">10</span> <span class="n">EDT</span><span class="p">]</span> <span class="p">[</span><span class="n">EROR</span><span class="p">]</span> <span class="n">Failed</span> <span class="n">to</span> <span class="n">ping</span> <span class="n">DB</span> <span class="n">retrying</span> <span class="ow">in</span> <span class="mi">10</span> <span class="n">seconds</span>
<span class="n">err</span><span class="o">-</span><span class="n">Error</span> <span class="mi">1045</span><span class="p">:</span> <span class="n">Access</span> <span class="n">denied</span> <span class="k">for</span> <span class="n">user</span> <span class="s1">&#39;mmuser&#39;</span><span class="o">@</span><span class="s1">&#39;localhost&#39;</span> <span class="p">(</span><span class="n">using</span> <span class="n">password</span><span class="p">:</span> <span class="n">YES</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>The Password in config.json</strong></p>
<p>The DataSource element of the <code class="docutils literal notranslate"><span class="pre">/opt/mattermost/config/config.json</span></code> file references the <code class="docutils literal notranslate"><span class="pre">mmuser</span></code> password. Open this file and search for <code class="docutils literal notranslate"><span class="pre">DataSource</span></code>. It’s value should be:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;mmuser:*mmuser-password*@tcp(*host-name-or-IP*:3306)/mattermost?charset=utf8mb4,utf8&amp;readTimeout=30s&amp;writeTimeout=30s&quot;</span>
</pre></div>
</div>
</div></blockquote>
<p>Check that the password is correct. If you correct an error, restart the Mattermost server by navigating to <code class="docutils literal notranslate"><span class="pre">/opt/mattermost</span></code> and issuing the command: <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">-u</span> <span class="pre">mattermost</span> <span class="pre">bin/mattermost</span></code>.</p>
<p><strong>Unsure of Password</strong></p>
<p>If you are not sure that the <code class="docutils literal notranslate"><span class="pre">mmuser</span></code> password is correct, attempt to log in to MySQL as <code class="docutils literal notranslate"><span class="pre">mmuser</span></code> by issuing the command <code class="docutils literal notranslate"><span class="pre">mysql</span> <span class="pre">-u</span> <span class="pre">mmuser</span> <span class="pre">-p</span></code>. You will be prompted for your password. If your login fails, you are not using the correct password.</p>
<p>With a new database installation, the easiest solution for an unknown password is to remove the existing <code class="docutils literal notranslate"><span class="pre">mmuser</span></code> and then recreating that user. You can do this by logging in to MySQL as <code class="docutils literal notranslate"><span class="pre">root</span></code> and issuing the following commands:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">drop</span> <span class="pre">user</span> <span class="pre">mmuser;</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">flush</span> <span class="pre">privileges;</span></code></li>
<li><table class="first docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">samp:</th><td class="field-body"><cite>create user ‘mmuser’&#64;’%’ identified by ‘{mmuser-password}’;</cite></td>
</tr>
</tbody>
</table>
</li>
</ul>
<p>If you recreate <code class="docutils literal notranslate"><span class="pre">mmuser</span></code>, ensure that this user has rights to the <code class="docutils literal notranslate"><span class="pre">mattermost</span></code> database by following the instructions given in :ref: <cite>mysql_grants</cite>.</p>
</div>
<div class="section" id="insufficient-user-privileges">
<h2>Insufficient User Privileges<a class="headerlink" href="#insufficient-user-privileges" title="Permalink to this headline">¶</a></h2>
<p>If the database exists and the username and password are correct, the <code class="docutils literal notranslate"><span class="pre">mmuser</span></code> may not have sufficient rights to access the <code class="docutils literal notranslate"><span class="pre">mattermost</span></code> database. If this is the case, you may see an error message such as:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">2017</span><span class="o">/</span><span class="mi">09</span><span class="o">/</span><span class="mi">20</span> <span class="mi">17</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">53</span> <span class="n">EDT</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">Pinging</span> <span class="n">SQL</span> <span class="n">master</span> <span class="n">database</span>
<span class="p">[</span><span class="mi">2017</span><span class="o">/</span><span class="mi">09</span><span class="o">/</span><span class="mi">20</span> <span class="mi">17</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mi">53</span> <span class="n">EDT</span><span class="p">]</span> <span class="p">[</span><span class="n">EROR</span><span class="p">]</span> <span class="n">Failed</span> <span class="n">to</span> <span class="n">ping</span> <span class="n">DB</span> <span class="n">retrying</span> <span class="ow">in</span> <span class="mi">10</span> <span class="n">seconds</span>
<span class="n">err</span><span class="o">-</span><span class="n">Error</span> <span class="mi">1044</span><span class="p">:</span> <span class="n">Access</span> <span class="n">denied</span> <span class="k">for</span> <span class="n">user</span> <span class="s1">&#39;mmuser&#39;</span><span class="o">@</span><span class="s1">&#39;%&#39;</span> <span class="n">to</span> <span class="n">database</span> <span class="s1">&#39;mattermost</span>
</pre></div>
</div>
</div></blockquote>
<p>Examine the error message closely. The user name displayed in the error message is the user identified in the <code class="docutils literal notranslate"><span class="pre">DataSource</span></code> element of the <code class="docutils literal notranslate"><span class="pre">/opt/mattermost/config/config.json</span></code> file. For example, if the error message reads``Access denied for user ‘muser’&#64;’%’ …`` you will know that you have misidentified the user as <code class="docutils literal notranslate"><span class="pre">muser</span></code> in the <code class="docutils literal notranslate"><span class="pre">config.json</span></code> file.</p>
<p>You can check if the user <code class="docutils literal notranslate"><span class="pre">mmuser</span></code> has access to the <code class="docutils literal notranslate"><span class="pre">mattermost</span></code> database by logging in to MySQL as <code class="docutils literal notranslate"><span class="pre">mmuser</span></code> and issuing the command: <code class="docutils literal notranslate"><span class="pre">show</span> <span class="pre">databases;</span></code>. If this user does not have rights to view the <code class="docutils literal notranslate"><span class="pre">mattermost</span></code> database, you will not see it in the output.</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+--------------------+</span>
<span class="o">|</span> <span class="n">Database</span>           <span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="o">|</span> <span class="n">information_schema</span> <span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="mi">1</span> <span class="n">rows</span> <span class="ow">in</span> <span class="nb">set</span> <span class="p">(</span><span class="mf">0.00</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p id="mysql-grants"><strong>Granting Privileges to mmuser</strong></p>
<p>If the <code class="docutils literal notranslate"><span class="pre">mattermost</span></code> database exists and <code class="docutils literal notranslate"><span class="pre">mmuser</span></code> cannot view it, exit from MySQL and then log in again as root. Issue the command <code class="docutils literal notranslate"><span class="pre">grant</span> <span class="pre">all</span> <span class="pre">privileges</span> <span class="pre">on</span> <span class="pre">mattermost.*</span> <span class="pre">to</span> <span class="pre">'mmuser'&#64;'%';</span></code> to grant all rights on <code class="docutils literal notranslate"><span class="pre">mattermost</span></code> to <code class="docutils literal notranslate"><span class="pre">mmuser</span></code>.</p>
<p>Restart the Mattermost server by navigating to the <code class="docutils literal notranslate"><span class="pre">/opt/mattermost</span></code> directory and entering the command <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">-u</span> <span class="pre">mattermost</span> <span class="pre">bin/mattermost</span></code>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../administration/upgrade.html" class="btn btn-neutral float-right" title="Upgrading Mattermost Server" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="troubleshooting.html" class="btn btn-neutral" title="Important Notes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2020 Mattermost

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
 




<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-cog">&nbsp;&nbsp;Options</span>&nbsp;
        <span class="fa fa-angle-up"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Contribute</dt>
            <dd>
                <a href="https://github.com/mattermost/docs/issues">Report a Problem</a>
            </dd>
            
            <dd>
                <a href="https://github.com/mattermost/docs/blob/master/source/install/trouble_mysql.rst"> Edit on GitHub</a>
            </dd>
            
        </dl>
    </div>
</div>


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../_static/myscript.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
	<header>
	<div class="header__container">
		<div class="search__icon">
			<i class="fa fa-search"></i>
		</div>
		<a href="https://docs.mattermost.com/" class="header__logo">
			<img width="176" src="https://about.mattermost.com/wp-content/uploads/2017/08/Mattermost-Logo-Blue.svg">
		</a>
		<div class="links__icon">
			<i class="fa fa-bars"></i>
		</div>
		<ul class="header__links">
			<li><a href="https://developers.mattermost.com/">Developers</a></li>
			<li><a href="https://mattermost.com/features/">Product</a></li>
			<li><a href="https://mattermost.com/pricing/">Pricing</a></li>
			<li><a href="https://mattermost.com/blog/">Blog</a></li>
			<li><a href="https://mattermost.com/download/">Download</a></li>
			<li><a href="https://mattermost.com/trial/">Trial</a></li>
		</ul>
		<div class="header__searchbar">
			<form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
                <input type="text" name="q" placeholder="Search by keyword" autofocus />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
		</div>
	</div>
</header>
	<script type="text/javascript">
		/* Temporary fix for the search capability. Fix has been committed to the theme's master;
		   however, waiting a new release to the theme.  This fix should remain in place until that
		   time.  sphinx_rtd_theme is current v0.1.10a0. Commit for the fix in the
		   theme can be found at: https://github.com/snide/sphinx_rtd_theme/commit/a5e0e304
		 */
        if(DOCUMENTATION_OPTIONS) {
			DOCUMENTATION_OPTIONS.SOURCELINK_SUFFIX = '.txt'
        }
    </script>


</body>
</html>